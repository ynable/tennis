<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ†ãƒ‹ã‚¹ ãƒ€ãƒ–ãƒ«ã‚¹ çµ„ã¿åˆã‚ã›ãƒ¡ãƒ¼ã‚«ãƒ¼</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>ğŸ¾ ãƒ†ãƒ‹ã‚¹ ãƒ€ãƒ–ãƒ«ã‚¹ çµ„ã¿åˆã‚ã›ãƒ¡ãƒ¼ã‚«ãƒ¼</h1>

    <!-- Step 1: ã‚³ãƒ¼ãƒˆæ•° & äººæ•°é¸æŠ -->
    <section id="step1" class="step active">
      <h2>Step 1: ã‚³ãƒ¼ãƒˆæ•°ã¨å‚åŠ äººæ•°ã‚’å…¥åŠ›</h2>
      <div class="court-player-select">
        <div class="input-row">
          <label for="courtCount">ä½¿ç”¨ã‚³ãƒ¼ãƒˆæ•°:</label>
          <input type="number" id="courtCount" min="1" max="20" value="2">
          <span class="input-hint">ã‚³ãƒ¼ãƒˆ</span>
        </div>
        <div class="input-row">
          <label for="playerCountInput">å‚åŠ äººæ•°:</label>
          <input type="number" id="playerCountInput" min="4" max="80" value="8">
          <span class="input-hint">äºº</span>
        </div>
        <p id="step1Info" class="info-message"></p>
        <p id="step1Error" class="error-message"></p>
      </div>
      <button class="btn primary" onclick="goToStep2()">æ¬¡ã¸</button>
    </section>

    <!-- Step 2: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åå…¥åŠ› -->
    <section id="step2" class="step">
      <h2>Step 2: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åã‚’å…¥åŠ›</h2>
      <div id="playerInputs" class="player-inputs"></div>
      <button class="btn secondary" onclick="goToStep1()">æˆ»ã‚‹</button>
      <button class="btn primary" onclick="goToStep3()">æ¬¡ã¸</button>
    </section>

    <!-- Step 3: åˆæˆ¦ã®çµ„ã¿åˆã‚ã›é¸æŠ -->
    <section id="step3" class="step">
      <h2>Step 3: åˆæˆ¦ã®çµ„ã¿åˆã‚ã›</h2>
      <p class="description">ç•ªå·é †ï¼ˆ1,2 vs 3,4 ...ï¼‰ã‚’åˆæˆ¦ã«ã—ã¾ã™ã‹ï¼Ÿ</p>
      <div class="first-match-select">
        <label>
          <input type="radio" name="firstMatch" value="sequential" checked>
          ã¯ã„ï¼ˆç•ªå·é †ã§çµ„ã‚€ï¼‰
        </label>
        <label>
          <input type="radio" name="firstMatch" value="random">
          ã„ã„ãˆï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã§çµ„ã‚€ï¼‰
        </label>
      </div>
      <button class="btn secondary" onclick="goToStep2FromStep3()">æˆ»ã‚‹</button>
      <button class="btn primary" onclick="generateMatches()">çµ„ã¿åˆã‚ã›ã‚’ç”Ÿæˆï¼</button>
    </section>

    <!-- Step 4: è©¦åˆä¸€è¦§ & ãƒã‚¤ãƒ³ãƒˆå…¥åŠ› -->
    <section id="step4" class="step">
      <h2>ğŸ† è©¦åˆä¸€è¦§</h2>
      <div id="matchList" class="match-list"></div>
      <div id="aggregateArea" class="fixed-bottom-bar">
        <button class="btn accent" onclick="showResults()">ğŸ“Š å¾—ç‚¹ã‚’é›†è¨ˆ</button>
      </div>
    </section>

    <!-- Step 5: çµæœè¡¨ç¤º -->
    <section id="step5" class="step">
      <h2>ğŸ“Š æœ€çµ‚çµæœ</h2>
      <div id="resultTable"></div>
      <button class="btn secondary" onclick="backToMatches()">è©¦åˆä¸€è¦§ã«æˆ»ã‚‹</button>
      <button class="btn primary" onclick="resetApp()">æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
    </section>
  </div>

  <script src="app.js"></script>
  <script>
    // Step1ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æƒ…å ±æ›´æ–°
    document.getElementById('courtCount').addEventListener('input', updateStep1Info);
    document.getElementById('playerCountInput').addEventListener('input', updateStep1Info);

    function updateStep1Info() {
      const courts = parseInt(document.getElementById('courtCount').value) || 0;
      const ppl = parseInt(document.getElementById('playerCountInput').value) || 0;
      const infoEl = document.getElementById('step1Info');
      const errorEl = document.getElementById('step1Error');
      infoEl.classList.remove('visible');
      infoEl.textContent = '';
      errorEl.classList.remove('visible');
      errorEl.textContent = '';

      if (courts < 1 || ppl < 4) return;
      const maxOnCourt = courts * 4;
      if (ppl > maxOnCourt) {
        infoEl.textContent = `â„¹ï¸ ${courts}ã‚³ãƒ¼ãƒˆ(æœ€å¤§${maxOnCourt}äºº)ã«å¯¾ã—ã¦${ppl}äººã§ã™ã€‚æ¯ãƒ©ã‚¦ãƒ³ãƒ‰${ppl - maxOnCourt}äººãŒäº¤ä»£ã§ä¼‘ã¿ã«ãªã‚Šã¾ã™ã€‚`;
        infoEl.classList.add('visible');
      } else if (ppl < maxOnCourt) {
        const active = Math.floor(ppl / 4);
        const rest = ppl - active * 4;
        if (active < 1) return;
        let msg = `â„¹ï¸ ${ppl}äººãªã®ã§ã€å®Ÿéš›ã«ä½¿ç”¨ã™ã‚‹ã‚³ãƒ¼ãƒˆã¯${active}ã‚³ãƒ¼ãƒˆã§ã™ã€‚`;
        if (rest > 0) msg += `æ¯ãƒ©ã‚¦ãƒ³ãƒ‰${rest}äººãŒäº¤ä»£ã§ä¼‘ã¿ã«ãªã‚Šã¾ã™ã€‚`;
        infoEl.textContent = msg;
        infoEl.classList.add('visible');
      }
    }
  </script>
</body>
</html>
